<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="theme-color" content="#0f4a73">
  <title>簡易給与計算</title>
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png">
  <link rel="apple-touch-icon" sizes="192x192" href="icons/icon-192.png">
  <link rel="stylesheet" href="style.css">
  <script defer src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script defer src="app.js"></script>
  <script defer src="help.js"></script>
  <script defer src="index.js"></script>
  <script defer src="sheets.js"></script>
  <script defer src="payroll.js"></script>
  <script defer src="settings.js"></script>
  <script defer src="router.js"></script>
</head>
<body>
  <header class="app-header">
    <div class="header-left">
      <div id="header-left-slot"></div>
      <span id="version"></span>
    </div>
    <div id="network-status" class="header-status network-status" aria-live="polite"></div>
    <div class="header-right">
      <div id="header-right-slot"></div>
    </div>
  </header>
  <main id="view-root" tabindex="-1"></main>

  <template id="view-home">
    <section class="view view-home" data-view="home">
      <h1 style="text-align:center">簡易給与計算</h1>
      <div id="settings-error" style="color:red;text-align:center;white-space:pre-line;"></div>
      <p id="store-status" style="text-align:center"></p>
      <div id="store-list"></div>
      <div id="offline-controls" class="offline-controls">
        <button id="offline-load-button" type="button">ローカルから読み込む</button>
        <p id="offline-workbook-info" class="offline-indicator" aria-live="polite"></p>
      </div>
      <div class="info-box" id="announcements"></div>
    </section>
  </template>

  <template id="view-sheets">
    <section class="view view-sheets" data-view="sheets">
      <h1 id="store-name" style="text-align:center"></h1>
      <h2 style="text-align:center">計算する月を選択</h2>
      <p id="status" style="text-align:center"></p>
      <div id="sheet-list"></div>
    </section>
  </template>

  <template id="view-payroll">
    <section class="view view-payroll" data-view="payroll">
      <h1 id="store-name" style="text-align:center"></h1>
      <h2 id="period" style="text-align:center"></h2>
      <p id="status" style="text-align:center"></p>
      <p id="total-salary" style="text-align:center"></p>
      <div id="base-wage-control" style="text-align:center">
        <span>時給：</span>
        <input type="number" id="base-wage-input">
        <button id="set-base-wage">一括設定</button>
      </div>
      <div id="transport-control" style="text-align:center">
        <span>交通費：</span>
        <input type="number" id="transport-input" value="0">
        <button id="set-transport">一括設定</button>
      </div>
      <div class="employees-table-container">
        <table id="employees">
          <thead>
            <tr>
              <th scope="col"><button type="button" class="sort-button" data-sort-key="name">従業員名</button></th>
              <th scope="col"><button type="button" class="sort-button" data-sort-key="baseWage">基本時給</button></th>
              <th scope="col"><button type="button" class="sort-button" data-sort-key="hours">勤務時間</button></th>
              <th scope="col"><button type="button" class="sort-button" data-sort-key="days">出勤日数</button></th>
              <th scope="col"><button type="button" class="sort-button" data-sort-key="absentDays">欠勤日数</button></th>
              <th scope="col"><button type="button" class="sort-button" data-sort-key="transport">交通費</button></th>
              <th scope="col"><button type="button" class="sort-button" data-sort-key="salary">給与</button></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <div id="actions">
        <button id="download">計算結果をダウンロード</button>
        <button id="open-source">計算元を開く</button>
      </div>
      <p id="error" style="color:red;text-align:center"></p>
    </section>
  </template>

  <template id="view-settings">
    <section class="view view-settings" data-view="settings">
      <h1 style="text-align:center">設定 <span style="font-size:1rem;font-weight:normal;">(参照)</span></h1>
      <div style="padding:1rem;">
        <div style="color:red;">設定は設定用スプレッドシートに移動しました。</div>
        <button id="open-settings-sheet" onclick="window.open('https://docs.google.com/spreadsheets/d/1qIKwli_xm3-a1HDs6DtE_XgQekXU9KYZyc2dDXAOdUY/edit?usp=sharing','_blank')">設定用スプレッドシートを開く</button><br>
        <div id="settings-error" style="color:red;white-space:pre-line;"></div><br><br>
        <label>店舗<select id="store-select"></select></label><br><br>
        <label>シートURL<input id="url" class="copyable-input" style="width:100%" readonly title="タップしてコピー"></label><br><br>
        <label>基本時給<input id="baseWage" type="number" disabled></label><br><br>
        <label>時間外倍率<input id="overtime" type="number" step="0.01" disabled></label><br><br>
        <label>従業員名除外ワード<input id="excludeWords" style="width:100%" placeholder="カンマ区切りで入力" disabled></label><br><br>
      </div>
    </section>
  </template>
</body>
</html>
